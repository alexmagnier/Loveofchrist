<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Синергия духовных даров — по Шварцу</title>
  <style>
    :root{
      --bg:#0f1221;
      --panel:#171a2c;
      --ink:#e9ecff;
      --muted:#b7c0ff;
      --accent:#8ea2ff;
      --green:#7fd37f; /* голова */
      --red:#ff8b8b;   /* руки */
      --blue:#7fb8ff;  /* сердце */
      --chip:#232642;
      --warn:#ffcf7d;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans", "Helvetica Neue", Arial;
      background: radial-gradient(1200px 800px at 20% -10%, #1c1f38 0, #0f1221 60%) fixed;
      color:var(--ink); line-height:1.45;
    }
    .wrap{max-width:1100px; margin:0 auto; padding:28px 16px 60px;}
    header{display:flex; flex-wrap:wrap; gap:12px; align-items:flex-end; justify-content:space-between; margin-bottom:18px}
    h1{font-size:clamp(22px, 2.6vw, 34px); margin:0; letter-spacing:.2px}
    header p{margin:0; color:var(--muted); max-width:700px}
    .card{
      background:linear-gradient(180deg, #1a1e33 0%, #121527 100%);
      border:1px solid #2a2e50; border-radius:16px; padding:16px; box-shadow: 0 10px 30px #0005;
    }
    .grid{display:grid; gap:14px}
    @media (min-width:900px){ .grid{grid-template-columns: 1.1fr 1fr}}
    label{display:block; font-weight:600; margin-bottom:8px}
    select{
      width:100%; min-height:220px; padding:8px; border-radius:12px; border:1px solid #2a2e50; background:#0f1221; color:var(--ink);
      outline:none;
    }
    .hint{color:var(--muted); font-size:13px; margin-top:8px}
    .toolbar{display:flex; gap:8px; flex-wrap:wrap; align-items:center}
    button{
      appearance:none; border:0; padding:10px 14px; border-radius:12px; font-weight:700; letter-spacing:.3px;
      background:linear-gradient(90deg, #7285ff, #86ffd5); color:#0b1130; cursor:pointer; transition:.15s transform;
    }
    .btn-ghost{background:#0f1221; color:var(--ink); border:1px solid #2a2e50}
    .btn-soft{background:#19213f; color:var(--ink); border:1px solid #2a2e50}
    button:hover{transform:translateY(-1px)}
    .chips{display:flex; flex-wrap:wrap; gap:8px; margin:8px 0 4px}
    .chip{padding:6px 10px; background:var(--chip); border:1px solid #32365a; border-radius:999px; font-size:13px; color:var(--muted)}
    .tag{font-weight:700; letter-spacing:.25px}
    .tag.green{color:var(--green)} .tag.red{color:var(--red)} .tag.blue{color:var(--blue)}
    h2{margin:12px 0 6px; font-size:20px}
    h3{margin:12px 0 6px; font-size:16px}
    .cols{display:grid; gap:12px}
    @media (min-width:900px){ .cols{grid-template-columns: repeat(2, 1fr)}}
    .pill{display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border-radius:999px; border:1px solid #2a2e50; background:#11142a}
    .legend{display:flex; gap:10px; flex-wrap:wrap}
    .bar{height:12px; background:#0f1221; border:1px solid #2a2e50; border-radius:999px; overflow:hidden}
    .bar > span{display:block; height:100%}
    .muted{color:var(--muted)}
    .tiny{font-size:12.5px}
    .empty{padding:14px; color:var(--muted)}
    details{background:#10132a; border:1px solid #2a2e50; border-radius:12px; padding:10px 12px}
    summary{cursor:pointer; font-weight:700}
    footer{margin-top:22px; color:var(--muted); font-size:13px}
    .bullet{margin:0; padding-left:16px}
    .bullet li{margin:6px 0}
    .note{font-size:13px; color:var(--muted)}
    .partners{display:flex; flex-wrap:wrap; gap:8px}
    .warn{border-left:4px solid var(--warn); background:#2a2630; padding:8px 10px; border-radius:8px; color:#ffe8b0; font-size:13px}
    .row{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Исследователь синергии даров</h1>
        <p>Выбери до пяти наиболее выраженных даров и нажми кнопку. Приложение покажет сильные стороны, рекомендуемые партнёрства, возможные «узкие места» и баланс трёх цветов Шварца: <span class="tag green">Голова (зелёный)</span> · <span class="tag red">Руки (красный)</span> · <span class="tag blue">Сердце (синий)</span>.</p>
      </div>
      <div class="toolbar">
        <button id="analyzeBtn">Исследовать синергию</button>
        <button id="demoBtn" class="btn-soft" title="Заполнить пример">Пример</button>
        <button id="resetBtn" class="btn-ghost" title="Очистить выбор">Сбросить</button>
      </div>
    </header>

    <div class="grid">
      <section class="card">
        <label for="gifts">Твои дары (макс. 5)</label>
        <select id="gifts" multiple>
          <optgroup label="Дары речи">
            <option>Пророчество</option>
            <option>Учение</option>
            <option>Душепопечение</option>
            <option>Мудрость</option>
            <option>Знание</option>
          </optgroup>
          <optgroup label="Дары руководства">
            <option>Апостол</option>
            <option>Пророк (служение)</option>
            <option>Евангелист</option>
            <option>Пастор</option>
            <option>Учитель (служение)</option>
          </optgroup>
          <optgroup label="Дары служения">
            <option>Служение (диакония)</option>
            <option>Помощь</option>
            <option>Руководство</option>
            <option>Управление (администрирование)</option>
            <option>Щедрость</option>
            <option>Милосердие</option>
            <option>Вера</option>
            <option>Гостеприимство</option>
            <option>Различение духов</option>
          </optgroup>
        </select>
        <div class="row">
          <div class="hint tiny" id="countHint">Выбрано: 0 / 5</div>
          <div class="hint tiny">Совет для мобильных: сначала выбери один пункт, затем ещё — удерживая пальцем и отмечая новые записи.</div>
        </div>
        <div id="warning" class="warn" style="display:none;">Выбрано больше 5 — лишние будут проигнорированы. Снимите выбор, чтобы анализ был точнее.</div>
        <div class="chips" id="chips"></div>
        <details class="note" style="margin-top:10px;">
          <summary>О трёх цветах</summary>
          <div class="legend" style="margin-top:8px">
            <span class="pill"><span class="tag green">●</span> Голова / истина, мудрость</span>
            <span class="pill"><span class="tag red">●</span> Руки / действие, организация</span>
            <span class="pill"><span class="tag blue">●</span> Сердце / любовь, отношения</span>
          </div>
        </details>
      </section>

      <section id="results" class="card" aria-live="polite">
        <div class="empty">Пока нет результатов. Выбери дары и нажми кнопку.</div>
      </section>
    </div>

    <footer>
      <div class="tiny">© Основано на подходе Кристиана Шварца («Три цвета служения», «Естественный рост общины»). Сильные стороны и рекомендации обобщены из нашего исследования.</div>
    </footer>
  </div>

  <script>
    // ===== База знаний =====
    const COLORS = { green:'Голова', red:'Руки', blue:'Сердце' };

    const GIFTS = {
      "Пророчество":{ color:'green', strengths:["духовная прозорливость; смелость говорить истину","задаёт направление и будит церковь к послушанию сейчас"], partners:["Учитель (служение)","Учение","Различение духов","Пастор","Управление (администрирование)"], risks:["крайность: «проекция дара» — ожидать одинаковой духовной чувствительности от всех","жёсткость тона без пасторской заботы"], roles:["пророческая команда","молитвенное и ходатайственное служение","наставничество по слышанию Бога"] },
      "Учение":{ color:'green', strengths:["ясно объясняет Писание и доктрину","формирует богословский фундамент, защищает от лжеучений"], partners:["Пророчество","Пророк (служение)","Евангелист","Пастор","Управление (администрирование)"], risks:["теоретичность без применения","сухость без «синего» сопереживания"], roles:["проповедь и курсы","школа служителей","апологетика, подготовка материалов"] },
      "Душепопечение":{ color:'blue', strengths:["эмпатия, конфиденциальность, длительное сопровождение","исцеляет отношения; снижает выгорание команды"], partners:["Пастор","Мудрость","Гостеприимство","Милосердие","Руководство"], risks:["перегруз (берёт слишком много историй на себя)","снижение границ — нужна супервизия и команда"], roles:["наставничество 1-на-1","группы поддержки","консультирование, молитва"] },
      "Мудрость":{ color:'green', strengths:["видит корень проблемы и \"третье решение\"","соединяет видение и реализацию, снимает конфликты"], partners:["Руководство","Управление (администрирование)","Пастор","Пророчество"], risks:["осторожность может тормозить смелые шаги веры","искушение стать \"последним арбитром\" вместо командности"], roles:["совет лидерской команде","медиатор в сложных кейсах","стратегия и приоритизация"] },
      "Знание":{ color:'green', strengths:["исследует и структурирует факты; память церкви","повышает убедительность и зрелость решений"], partners:["Учение","Учитель (служение)","Управление (администрирование)","Евангелист"], risks:["информационный перегруз и отрыв от практики","споры по мелочам"], roles:["исследователь/редактор","библиотека и контент","аналитика для миссии"] },
      "Апостол":{ color:'red', strengths:["первопроходец: запускает новые дела и общины","видит «большую картину», делегирует и умножает лидеров"], partners:["Пророк (служение)","Учитель (служение)","Управление (администрирование)","Руководство","Вера"], risks:["перегорание команды из-за темпа","игнор деталей и пасторской опеки"], roles:["основание новых служений","миссии/мультипликация","коучинг лидеров"] },
      "Пророк (служение)":{ color:'blue', strengths:["страж видения и чистоты; чуткость к Святому Духу","утешает и обличает со властью"], partners:["Апостол","Учитель (служение)","Различение духов","Пастор"], risks:["недооценка структур и процесса","конфликты без проверки и подотчётности"], roles:["пророческая команда","молитва/ходатайство","наставление лидеров о Божьем курсе"] },
      "Евангелист":{ color:'red', strengths:["ясно и просто возвещает Евангелие; дерзновение","строит мосты с неверующими и побуждает церковь выйти наружу"], partners:["Пастор","Учитель (служение)","Гостеприимство","Щедрость","Руководство"], risks:["сосредоточенность лишь на обращении без последующего ученичества","усталость от постоянных встреч без команды поддержки"], roles:["личное и массовое благовестие","обучение персональному свидетельству","организация евангелизаций"] },
      "Пастор":{ color:'blue', strengths:["создаёт атмосферу семьи, защищает стадо","обеспечивает непрерывное ученичество и единство"], partners:["Евангелист","Душепопечение","Учитель (служение)","Руководство","Гостеприимство"], risks:["консерватизм, страх перемен","персональная перегрузка — нужно делегировать лидерам малых групп"], roles:["координация пастырской сети","урегулирование конфликтов","забота о новообращённых"] },
      "Учитель (служение)":{ color:'green', strengths:["формирует богословский фундамент, обучает служителей","сохраняет единство в истине и долгую перспективу"], partners:["Пророк (служение)","Евангелист","Пастор","Знание","Различение духов"], risks:["чрезмерная критичность к новому","учение без практической площадки"], roles:["проповедь/семинары","подготовка лидеров","разбор спорных вопросов, апологетика"] },
      "Служение (диакония)":{ color:'red', strengths:["делает невидимую, но критично важную работу","освобождает проповедников/пасторов для их фокуса"], partners:["Руководство","Управление (администрирование)","Евангелист","Пастор"], risks:["чувство недооценённости; «всё на себе»","выгорание без сменяемости/команды"], roles:["логистика мероприятий","техническая команда/кухня/уборка","кейтеринг/транспорт/сетап"] },
      "Помощь":{ color:'red', strengths:["подставляет плечо конкретным людям; верная «правая рука»","строит культуру взаимопомощи и преемственности"], partners:["Руководство","Пастор","Милосердие","Душепопечение","Управление (администрирование)"], risks:["неумение говорить «нет» → перегруз","растворение видимости вклада — важно признание"], roles:["ассистент лидера/проекта","наставник новичка","кризисная помощь семьям"] },
      "Руководство":{ color:'red', strengths:["превращает видение в план, распределяет роли","вдохновляет и держит курс, принимает решения"], partners:["Мудрость","Управление (администрирование)","Пастор","Евангелист","Знание"], risks:["контроль/автократия; забыть, что лидер — слуга","ориентация на задачи в ущерб людям"], roles:["координация служений","планирование/OKR/дедлайны","развитие волонтёров"] },
      "Управление (администрирование)":{ color:'green', strengths:["структуры, процессы, финансы: из хаоса — порядок","синхронизирует служения и ресурсы"], partners:["Руководство","Апостол","Учитель (служение)","Евангелист","Знание"], risks:["бюрократия/«душим Духа»; технократизм","зацикленность на деталях"], roles:["бюджеты/расписания/логистика","юридические вопросы/учёт","PM больших событий"] },
      "Щедрость":{ color:'blue', strengths:["радостно обеспечивает Божьи проекты ресурсами","вдохновляет церковь на жертвенность"], partners:["Управление (администрирование)","Евангелист","Пастор","Руководство","Вера"], risks:["импульсивные пожертвования без стратегии","скрытая усталость — важно видеть плоды"], roles:["фандрайзинг/пожертвования","поддержка миссий и нуждающихся","стартовые взносы под проекты"] },
      "Милосердие":{ color:'blue', strengths:["видит уязвимых и несёт практическую любовь","создаёт атмосферу принятия"], partners:["Душепопечение","Гостеприимство","Пастор","Щедрость"], risks:["эмоциональное истощение; размытые границы","идеализм без процессов безопасности"], roles:["соцслужение/реабилитация","посещение больных/узников","кризисная поддержка"] },
      "Вера":{ color:'blue', strengths:["ожидает невозможного и зажигает церковь просить больше","катализирует молитвенные и миссионерские прорывы"], partners:["Апостол","Евангелист","Щедрость","Пастор","Руководство"], risks:["путать веру с рискованностью без проверки","разочарование при задержках — нужна команда молитвы"], roles:["молитвенные инициативы/пост","видение и цели веры","поддержка проектов на старте"] },
      "Гостеприимство":{ color:'blue', strengths:["делает из группы — семью; открытый дом как миссия","ускоряет интеграцию новообращённых"], partners:["Евангелист","Пастор","Душепопечение","Щедрость","Служение (диакония)"], risks:["выгорание хозяйки/хозяина; «дом всегда открыт» без границ","нагрузка на бюджет семьи"], roles:["домашние группы","команда приветствия/кофе-бар","приём гостей/миссионеров"] },
      "Различение духов":{ color:'green', strengths:["охраняет церковь от обольщений; видит духовный источник","помогает служить точечно: когда нужно — обличать/освобождать"], partners:["Пророчество","Пророк (служение)","Учитель (служение)","Пастор"], risks:["подозрительность/жёсткие ярлыки","замена проверки общиной личной «интуицией»"], roles:["проверка пророчеств","молитва освобождения","этический/доктринальный комплаенс"] }
    };

    const SYNERGIES = [
      {set:["Учитель (служение)","Пророк (служение)"], text:"Истина + направление: пророческое видение проверяется и укореняется в Писании; команда принимает смелые, но здравые решения."},
      {set:["Евангелист","Гостеприимство"], text:"От обращения к ученичеству: домашние столы + благовестие дают устойчивое присоединение новых людей."},
      {set:["Апостол","Управление (администрирование)"], text:"Запуск + система: пионерские проекты получают структуры и не рассыпаются после старта."},
      {set:["Пастор","Душепопечение"], text:"Стабильность стада: сеть заботы предотвращает выгорание и потери новообращённых."},
      {set:["Вера","Щедрость"], text:"Прорывы ресурсов: вера видит цель, щедрость открывает двери финансирования."},
      {set:["Руководство","Мудрость"], text:"Решительность с рассудительностью: лидер принимает решения, мудрый выстраивает приоритеты и снижает конфликты."},
      {set:["Пророчество","Различение духов"], text:"Безопасные проявления Духа: пророческие слова проверяются и применяются адресно."},
      {set:["Знание","Учение"], text:"Глубокая база: исследования превращаются в понятные курсы и материалы."}
    ];

    // ===== UI =====
    const select = document.getElementById('gifts');
    const chips  = document.getElementById('chips');
    const results = document.getElementById('results');
    const btn = document.getElementById('analyzeBtn');
    const demoBtn = document.getElementById('demoBtn');
    const resetBtn = document.getElementById('resetBtn');
    const warnBox = document.getElementById('warning');
    const countHint = document.getElementById('countHint');

    function getSelected(limit=5){
      const chosen = Array.from(select.selectedOptions).map(o=>o.value);
      if(chosen.length > limit){ warnBox.style.display='block'; } else { warnBox.style.display='none'; }
      return chosen.slice(0, limit);
    }

    function setSelected(names){
      // проставляем selected по именам
      Array.from(select.options).forEach(o => o.selected = names.includes(o.value));
      renderChips();
    }

    function renderChips(){
      const chosen = Array.from(select.selectedOptions).map(o=>o.value);
      const limited = chosen.slice(0,5);
      countHint.textContent = `Выбрано: ${chosen.length} / 5`;
      chips.innerHTML = limited.map(name=>{
        const c = GIFTS[name]?.color || 'green';
        return `<span class="chip" title="Нажми, чтобы снять выбор" data-remove="${name}"><span class="tag ${c}">●</span> ${name} ✕</span>`;
      }).join('') || `<span class="note tiny">выбрано 0 из 5</span>`;

      // кликабельное снятие выбора по чипу
      Array.from(chips.querySelectorAll('[data-remove]')).forEach(el=>{
        el.addEventListener('click', ()=>{
          const name = el.getAttribute('data-remove');
          const opt = Array.from(select.options).find(o=>o.value===name);
          if(opt){ opt.selected = false; renderChips(); }
        });
      });
    }
    renderChips();
    select.addEventListener('change', renderChips);

    function colorCounts(names){
      const counts = {green:0, red:0, blue:0};
      names.forEach(n=>counts[GIFTS[n].color]++);
      return counts;
    }

    function recommendPartners(names){
      const score = {};
      names.forEach(n=>{
        (GIFTS[n].partners||[]).forEach(p=>{
          if(names.includes(p)) return;
          score[p] = (score[p]||0)+1;
        });
      });
      return Object.entries(score)
        .sort((a,b)=>b[1]-a[1])
        .slice(0,8)
        .map(([name, s])=>({name, s, color: GIFTS[name]?.color || 'green'}));
    }

    function activeSynergies(names){
      return SYNERGIES.filter(s => s.set.every(x => names.includes(x)));
    }

    function aggregateStrengths(names){
      const arr = [];
      names.forEach(n => (GIFTS[n].strengths||[]).forEach(s=>arr.push(`• ${s} (${n})`)));
      return arr.slice(0, 10);
    }

    function aggregateRisks(names){
      const arr = [];
      names.forEach(n => (GIFTS[n].risks||[]).forEach(s=>arr.push(`• ${s} (${n})`)));
      return Array.from(new Set(arr)).slice(0, 8);
    }

    function renderBar(counts){
      const total = Math.max(1, counts.green+counts.red+counts.blue);
      const g = Math.round(counts.green/total*100), r=Math.round(counts.red/total*100), b=100-g-r;
      return `
        <div class="bar" aria-label="цветовой баланс">
          <span style="width:${g}%; background:var(--green)"></span>
          <span style="width:${r}%; background:var(--red)"></span>
          <span style="width:${b}%; background:var(--blue)"></span>
        </div>
        <div class="legend" style="margin-top:6px">
          <span class="pill"><span class="tag green">●</span> Голова: ${counts.green}</span>
          <span class="pill"><span class="tag red">●</span> Руки: ${counts.red}</span>
          <span class="pill"><span class="tag blue">●</span> Сердце: ${counts.blue}</span>
        </div>`;
    }

    function analyze(){
      const chosen = getSelected();
      if(!chosen.length){
        results.innerHTML = `<div class="empty">Пока нет результатов. Выбери хотя бы один дар.</div>`;
        return;
      }
      const counts = colorCounts(chosen);
      const partners = recommendPartners(chosen);
      const synergies = activeSynergies(chosen);
      const strengths = aggregateStrengths(chosen);
      const risks = aggregateRisks(chosen);

      results.innerHTML = `
        <div class="chips" style="margin-bottom:6px">
          ${chosen.map(n=>`<span class="chip"><span class="tag ${GIFTS[n].color}">●</span> ${n}</span>`).join('')}
        </div>

        <h2>Сильные стороны</h2>
        <ul class="bullet">${strengths.map(s=>`<li>${s}</li>`).join('')}</ul>

        <h2>Рекомендуемые партнёры</h2>
        <div class="partners">
          ${partners.map(p=>`<span class="pill"><span class="tag ${p.color}">●</span> ${p.name} <span class="muted tiny">×${p.s}</span></span>`).join('') || '<span class="note">Подходящие партнёры появятся здесь</span>'}
        </div>

        <h2>Командная синергия</h2>
        ${synergies.length
          ? `<ul class="bullet">${synergies.map(s=>`<li><strong>${s.set.join(" + ")}</strong>: ${s.text}</li>`).join('')}</ul>`
          : `<div class="note">Подсказка: попробуй пары «Евангелист + Гостеприимство», «Апостол + Администрирование», «Пастор + Душепопечение» и др.</div>`
        }

        <h2>Баланс трёх цветов</h2>
        ${renderBar(counts)}
        <p class="tiny muted" style="margin-top:6px">Идея Шварца: зрелая команда отражает все три измерения — истину (зелёный), действие (красный), любовь (синий). Если какой-то цвет проседает, ищи партнёров из него.</p>

        <h2>Возможные риски и как их нивелировать</h2>
        <ul class="bullet">${risks.map(r=>`<li>${r}</li>`).join('')}</ul>

        <details style="margin-top:10px">
          <summary>Сферы служения и роли (по твоему набору)</summary>
          <div class="cols" style="margin-top:10px">
            ${chosen.map(n=>`
              <div class="card" style="padding:10px">
                <h3 style="margin:0 0 6px"><span class="tag ${GIFTS[n].color}">●</span> ${n}</h3>
                <div class="tiny muted">Роли:</div>
                <ul class="bullet tiny">${(GIFTS[n].roles||[]).map(x=>`<li>${x}</li>`).join('')}</ul>
                <div class="tiny muted" style="margin-top:6px">Лучше всего работает с:</div>
                <div class="partners" style="margin-top:4px">
                  ${(GIFTS[n].partners||[]).slice(0,5).map(p=>`<span class="pill tiny"><span class="tag ${GIFTS[p]?.color||'green'}">●</span> ${p}</span>`).join('')}
                </div>
              </div>
            `).join('')}
          </div>
        </details>
      `;
    }

    // Кнопки
    btn.addEventListener('click', analyze);
    demoBtn.addEventListener('click', ()=>{
      setSelected(["Евангелист","Гостеприимство","Пастор","Учитель (служение)","Мудрость"]);
      analyze();
    });
    resetBtn.addEventListener('click', ()=>{
      Array.from(select.options).forEach(o => o.selected=false);
      renderChips();
      results.innerHTML = '<div class="empty">Пока нет результатов. Выбери дары и нажми кнопку.</div>';
      warnBox.style.display='none';
    });
  </script>
</body>
</html>
